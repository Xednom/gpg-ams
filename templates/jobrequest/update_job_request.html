{% extends 'base.html' %}
{% load templatetagname %}
{% block title %}
GPG System | View Job Request
{% endblock %}
{% block dashboard_notif %}
<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">
      View Due Diligence work assigned
    </h1>
  </div>
</div>
{% endblock %}
{% block content %}
<br>
<ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="{% url 'users:home' %}">Dashboard</a>
  </li>
  <li class="breadcrumb-item active">
    View Job Requests
  </li>
</ol>
<div id="gpg-job-request" v-cloak>
  <div id="content-wrapper">
    <div class="container-fluid">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            Assigned Job requests
          </div>
          <div class="panel-body">
            <table width="100%" class="table table-striped table-bordered table-hover jobRequestTable"
              id="jobRequestTable">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Due date</th>
                  <th>Client Code</th>
                  <th>Job Request Title</th>
                  <th>Job Request sent Via</th>
                  <th>Job Request Instruction</th>
                  <th>Total hours and minutes allocated</th>
                  <th>Project Managers</th>
                  <th>VA admin support</th>
                  <th>Status of the job request</th>
                  <th>Notes and coaching from project manager</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="15" class="text-center bg-warning" v-if="!jobRequests.length">You can use "Date", "Client
                    Code" or "VA admin support" to search a data to update/delete.</td>
                </tr>
                <tr class="odd gradeX" v-for="job in jobRequests">
                  <td>[[ job.date ]]</td>
                  <td>[[ job.due_date ]]</td>
                  <td>[[ job.client_code ]]</td>
                  <td>[[ job.job_request_title ]]</td>
                  <td>[[ job.job_request_sent_via ]]</td>
                  <td>[[ job.job_request_instruction ]]</td>
                  <td>[[ job.total_hours_minutes_allocated ]]</td>
                  <td>[[ job.project_managers ]]</td>
                  <td>[[ job.VA_admin_support ]]</td>
                  <td>[[ job.status ]]</td>
                  <td>[[ job.notes_and_coaching_from_project_manager ]]</td>
                  {% if perms.jobrequest.change_jobrequest %}
                  <td>
                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editmodal"
                      v-on:click="getJobRequest(job.id)">
                      Launch demo modal
                    </button>
                  </td>
                  <!-- <button type="button" class="btn btn-danger fa fa-trash" v-on:click="deleteJobRequest(job.id)">

                          </button></td> -->
                  {% endif %}
                </tr>
              </tbody>
            </table>
            <!-- /.table-responsive -->
          </div>
          <!-- show a specific info based on view -->
          <!-- Modal -->
          <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
            aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="exampleModalLongTitle">Edit Job request information for [[
                    currentJobRequest.company_name ]]</h4>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <form v-on:submit.prevent="updateDueDiligence()">
                  <div class="modal-body">
                    <div class="panel panel-default">
                      <div class="panel-heading">
                        Due Diligence work Information for [[ currentJobRequest.company_name ]]
                      </div>
                      <div class="panel-body">
                        <h4 class="title1">Job Request Informations</h4>
                        <hr>
                        <form v-on:submit.prevent=updateJobRequest>
                          {% csrf_token %}
                          <div class="form-group col-md-4 col-sm-12">
                            <label for="brand_name">Category</label>
                            <input class="form-control" id="brand_name" v-model="currentJobRequest.category" autocomplete="off" />
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>Requestor's Name</label>
                            <input type="text" class="form-control" v-model="currentJobRequest.requestors_name" autocomplete="off" />
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>Company Name</label>
                            <input type="text" class="form-control" v-model="currentJobRequest.company_name" autocomplete="off" />
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>Job Request number</label>
                            <input type="text" class="form-control" v-model="currentJobRequest.job_request_number" autocomplete="off">
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>Job Request Title</label>
                            <input type="text" class="form-control" v-model="currentJobRequest.job_request_title" autocomplete="off">
                          </div>
                          <div class="form-group col-md-12 col-sm-12">
                            <label>Job Request Instructions</label>
                            <textarea cols="15" rows="15" class="form-control" v-model="currentJobRequest.job_request_instruction"></textarea>
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>Assigned Project Manager </label>
                            <select class="form-control" v-model="currentJobRequest.assigned_project_managers">
                              <option v-for="pm in projectManagers">[[pm.project_manager]]</option>
                            </select>
                          </div>
                          <div class="form-group col-md-4 col-sm-12">
                            <label>VA admin support</label>
                            <input type="text" class="form-control" v-model="currentJobRequest.VA_admin_support" autocomplete="off" />
                          </div>
                          <div class="form-group col-md-12 col-sm-12">
                            <label>Notes and coaching from Project Manager</label>
                            <textarea class="form-control" rows="8" cols="80"
                              v-model="currentJobRequest.notes_and_coaching_from_project_manager" autocomlete="off"></textarea>
                          </div>
                      </div>
                      <!-- panelbody ends here -->
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}